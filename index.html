<!doctype html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>hello phaser!</title>
    <script src="//cdn.jsdelivr.net/phaser/2.5.0/phaser.min.js"></script>
  </head>
  <body>
    <script type="text/javascript">
      window.onload = function() {
        var game = new Phaser.Game(300, 500, Phaser.CANVAS, '', { preload: preload, create: create });
        var on = false;
        var music;
        var chopinSongs = [];
        var otherSongs = [];
        var songs;
        var chopinSongsNum = 10;
        var otherSongsNum = 3;
        var stage = 0;

        function preload () {
          game.load.image('play', 'play-button.svg');
          for (i = 0; i < chopinSongsNum; i++) {
            name = 'c' + i.toString();
            path = '/music/chopin/c' + i.toString() + '.mp3';

            game.load.audio(name, path);
            chopinSongs.push(name);
          }
          for (i = 0; i < otherSongsNum; i++) {
            name = 'o' + i.toString();
            path = '/music/others/o' + i.toString() + '.mp3';

            game.load.audio(name, path);
            otherSongs.push(name);
          }
          songs = chopinSongs.concat(otherSongs);
        }

        function create () {
          game.stage.backgroundColor = "#336600";
          nextSong();
        }

        function nextSong() {
          music = game.add.audio(songs[stage]);
          questionText = game.add.text(10, 10, "Did Chopin write this?", { font: "20px Arial" });
          button = game.add.button(10,100,'play',play,this);
          button.scale.setTo(0.5,0.5);

          var text1 = game.add.text(10, 400-10, "Yes, Chopid did.", { font: "20px Arial" });
          var text2 = game.add.text(10, 400-60, "Nah...", { font: "20px Arial" });
          text1.inputEnabled = true;
          text2.inputEnabled = true;

          var text1Answer = songs[stage][0] == 'c';
          var text2Answer = !text1Answer;

          text1.events.onInputDown.add(function() { checkAnswer(text1Answer) }, this);
          text2.events.onInputDown.add(function() { checkAnswer(text2Answer) }, this);
        }

        function checkAnswer(answer) {
          if (answer) {
            alert('Good job!');
            stage++;
            music.stop();
            nextSong();
            on = false;
          } else {
            tryAgain();
          }
        }

        function play(button) {
          on = !on;
          if (on) {
            music.play();
          } else {
            music.stop();
          }
        }

        function tryAgain() {
          alert('Try again please...');
        }
      };
    </script>
  </body>
</html>
